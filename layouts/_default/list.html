{{ define "main" }}

{{ $all := .Pages.ByDate.Reverse }}

<aside class="sidebar">
  <div class="breadcrumbs">我的定投日志 » 守币日记</div>

  {{ range ($all.GroupByDate "2006") }}
    <details class="tree" open>
      <summary>{{ .Key }} 年</summary>

      {{ range ((.Pages.ByDate.Reverse).GroupByDate "2006-01") }}
        {{ $ym := .Key }}
        {{ $m := index (split $ym "-") 1 }}

        <details open>
<summary class="month-summary">
  {{ $m }}月（{{ len .Pages }}）
  <span class="jump-link">
    · <a href="#ym-{{ $ym }}">跳到右侧</a>
  </span>
</summary>


          <ul class="day-list">
            {{ range (.Pages.ByDate.Reverse) }}
              <li>
                <a href="{{ .RelPermalink }}">
                  {{- $t := .Title -}}
                  {{- $short := replaceRE "^([0-9]{4}-[0-9]{2}-[0-9]{2}).*?(收益率：[^%]+%).*$" "$1，$2" $t -}}
                  {{- if eq $short $t -}}
                    {{- .Date.Format "2006-01-02" -}}
                  {{- else -}}
                    {{- $short -}}
                  {{- end -}}
                </a>
              </li>
            {{ end }}
          </ul>
        </details>
      {{ end }}
    </details>
  {{ end }}
</aside>

<section class="content">
  <h1>{{ .Title }}</h1>
  <p style="color:#666; font-size:13px;">默认全部展开；想折叠就点击左侧年份/月份标题。</p>

  {{ range ($all.GroupByDate "2006-01") }}
    {{ $ym := .Key }}
    {{ $m := index (split $ym "-") 1 }}

    <h2 id="ym-{{ $ym }}">{{ $m }}月</h2>

    <ul>
      {{ range (.Pages.ByDate.Reverse) }}
        <li>
          <a href="{{ .RelPermalink }}">
            {{- $t := .Title -}}
            {{- $short := replaceRE "^([0-9]{4}-[0-9]{2}-[0-9]{2}).*?(收益率：[^%]+%).*$" "$1，$2" $t -}}
            {{- if eq $short $t -}}
              {{- .Date.Format "2006-01-02" -}}
            {{- else -}}
              {{- $short -}}
            {{- end -}}
          </a>
        </li>
      {{ end }}
    </ul>
  {{ end }}
</section>

{{ end }}
